<p>Wouldn't it be nice if we could combine our data on theme names with the number sets per theme?&nbsp;</p><p>Let's use the <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html?highlight=merge#pandas.DataFrame.merge" rel="noopener noreferrer" target="_blank">.merge() method</a> to combine two separate DataFrames into one. The merge method works on columns with the same <strong>name</strong> in both DataFrames. </p><p>Currently, our theme_ids and our number of sets per theme live inside a Series called <code>set_theme_count</code>. </p><figure><img src="https://img-c.udemycdn.com/redactor/raw/2020-10-10_10-22-32-26ca451e68832f127ca7c6cb4608af04.png"></figure><p>To make sure we have a column with the name <code>id</code>, I'll convert this Pandas Series into a Pandas DataFrame. </p><figure><img src="https://img-c.udemycdn.com/redactor/raw/2020-10-10_10-22-41-1a15ad7b2cb2c0fc80fdd8755ae68fef.png"></figure><p>Here I'm providing a dictionary to create the DataFrame. The keys in the dictionary become my column names.</p><p><br></p><p><strong>The Pandas .merge() function</strong></p><p>To <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html" rel="noopener noreferrer" target="_blank">.merge()</a> two DataFrame along a particular column, we need to provide our two DataFrames and then the <strong>column name</strong> on which to merge. This is why we set <code>on='id'</code>. Both our <code>set_theme_count</code> and our <code>themes</code> DataFrames have a column with this name. </p><pre class="prettyprint linenums">merged_df = pd.merge(set_theme_count, themes, on='id')</pre><p> The first 3 rows in our merged DataFrame look like this:</p><figure><img src="https://img-c.udemycdn.com/redactor/raw/2020-10-10_10-23-08-5d894473bb671b773bffa7dea43bd6e1.png"></figure><p>Aha! Star Wars is indeed the theme with the most LEGO sets. Let's plot the top 10 themes on a chart.</p><p><br></p><p><strong>Creating a Bar Chart</strong></p><p>Matplotlib can create almost any chart imaginable with very few lines of code. Using <a href="https://matplotlib.org/3.3.2/api/_as_gen/matplotlib.pyplot.bar.html" rel="noopener noreferrer" target="_blank">.bar()</a> we can provide our theme names and the number of sets.&nbsp;This is what we get:</p><figure><img src="https://img-c.udemycdn.com/redactor/raw/2020-10-10_10-23-26-ffad46550f606a5df52fc267b1aba0f4.png"></figure><p>That worked, but it's almost unreadable.  The good thing for us is that we already know how to customize our charts!&nbsp;Here's what we get when we increase the size of our figure, add some labels, and most importantly, rotate the category names on the x-axis so that they don't overlap.</p><pre class="prettyprint linenums">plt.figure(figsize=(14,8))
plt.xticks(fontsize=14, rotation=45)
plt.yticks(fontsize=14)
plt.ylabel('Nr of Sets', fontsize=14)
plt.xlabel('Theme Name', fontsize=14)

plt.bar(merged_df.name[:10], merged_df.set_count[:10])</pre><figure><img src="https://img-c.udemycdn.com/redactor/raw/2020-10-10_10-23-53-a3f1d8fb51bca0e045b9ed97d58b787a.png"></figure><p><br></p><p>Niiiiice. So what can we see here? Well, a couple of these themes like Star Wars, Town, or Ninjago are what I&nbsp;would think of when I&nbsp;think of LEGO. However, it looks like LEGO also produces a huge number of ... books and key chains?!?!&nbsp;I guess I'm showing my age here, but it's interesting that the LEGO company seems to produce so much more these days than just plastic bricks. The 'Gear' category itself is huge and includes everything from bags to pencil cases apparently. Has LEGO strayed from its core business or is it successfully diversifying?&nbsp;That we can't answer from our dataset. I'll leave that one up to a business school case study to decide. </p><p><br></p>