<p>Often you find yourself needing to summarise data. This is where the .groupby()&nbsp;function comes in really handy. However, sometimes you want to run even more operations based on a particular DataFrame column. This is where the <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.agg.html" rel="noopener noreferrer" target="_blank">.agg()</a> method comes in. </p><p>In our case, we want to calculate the number of different themes by calendar year. This means we have to group the data by year and then count the number of unique theme_ids for that year. </p><p><strong>Number of Themes per Calendar Year</strong></p><p>We can accomplish this by chaining the <code>.groupby() </code>and the <code>.agg()</code> functions together:</p><figure><img src="https://img-c.udemycdn.com/redactor/raw/2020-10-10_10-08-17-3130eee0444d4983a649a7af0213bf17.png"></figure><p>Note, the <code>.agg()</code> method takes a dictionary as an argument. In this dictionary, we specify which operation we'd like to apply to each column. In our case, we just want to calculate the number of unique entries in the theme_id column by using our old friend, the <code>.nunique()</code> method. </p><p>Let's give our column in <code>themes_by_year</code> a more appropriate name and let's take a look at what we've got:</p><figure><img src="https://img-c.udemycdn.com/redactor/raw/2020-10-10_10-08-30-8c14d024f59494861a599bf138da8319.png"></figure><p>Here we can see that LEGO&nbsp;only had 2 themes during the first few years, but just like the number of sets the number of themes expanded manifold over the years. Let's plot this on a chart again. </p><p><br></p><h4>Challenge</h4><p><br></p><p>Create a line plot of the number of themes released year-on-year. Only include the full calendar years in the dataset (1949 to 2019). </p><p><br></p><p>.</p><p>.</p><p>..</p><p>...</p><p>..</p><p>.</p><p>.</p><p><strong>Here's the solution:</strong></p><p><br></p><pre class="prettyprint linenums">plt.plot(themes_by_year.index[:-2], themes_by_year.nr_themes[:-2])</pre><p>Again, we're using the same slicing technique as before. In the chart, we can see that LEGO has pretty consistently added more and more themes until the mid-1990s. From then the number of themes has stagnated for around 10 years or so until the early 2010s. </p><figure><img src="https://img-c.udemycdn.com/redactor/raw/2020-10-10_10-08-56-931b5f190a914aae2db436a019b694c3.png"></figure>