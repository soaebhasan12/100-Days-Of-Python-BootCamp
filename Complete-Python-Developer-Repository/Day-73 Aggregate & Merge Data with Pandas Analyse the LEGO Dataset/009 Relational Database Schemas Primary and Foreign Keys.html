<p>LEGO has licensed many hit franchises from Harry Potter to Marvel Super Heros to many others. But which theme has the largest number of individual sets? Is it one of LEGO's own themes like Ninjago or Technic or is it a third party theme? Let's analyse LEGO's product lines in more detail!</p><p><strong>Number of Sets per LEGO&nbsp;Theme</strong></p><p>To count the number of sets per Theme we can use the <code>.value_counts()</code> method on our<code> theme_id</code> column. But there's one problem:</p><figure><img src="https://img-c.udemycdn.com/redactor/raw/2020-10-10_10-18-04-9bbb260d201de1b104afa814b9e6b1ca.png"></figure><p>We have no idea what our themes are actually called!  Ok, we can see that the theme with id 158 is the largest theme containing 753 individual sets, but what's that theme called? This is not very helpful. We need to find the names of the themes based on the <code>theme_id</code> from the <code>themes.csv</code> file. </p><p><br></p><p><strong>Mini-Challenge</strong></p><p>Display the database schema (link:&nbsp;https://i.imgur.com/Sg4lcjx.png) inside the Notebook. You should see something like this:</p><figure><img src="https://img-c.udemycdn.com/redactor/raw/2020-10-10_10-18-49-1748f6889ed0e6b0565269b40f279453.png"></figure><p><br></p><p><strong>Solution: Embedding images in a Markdown Cell:</strong></p><p>To display an image in a Text (aka Markdown)&nbsp;cell, all you need to do is use the HTML&nbsp;&lt;img&gt; tag.</p><pre class="prettyprint linenums">&lt;img src="https://i.imgur.com/Sg4lcjx.png"&gt;</pre><p><br></p><p><strong>Working with a Relational Database</strong></p><p>What is a database schema?&nbsp;A schema is just how the database is organised. Many relational databases, such as our LEGO&nbsp;data, is split into individual tables. We have separate tables for the colours, the sets and the thems. With a relational database, the tables are linked to each other through their keys.</p><p> </p><p><strong>Understand the theme.csv file</strong></p><p>The themes.csv file has the actual theme names. How is this table linked to the others tables? Well, the sets .csv has <code>theme_ids</code> which match the <code>id</code> column in the themes.csv. </p><p>This means that the <code>theme_id</code> is the <strong>foreign key</strong> inside the sets.csv. Many different sets can be part of the same theme. But <em>inside</em> the themes.csv, each <code>theme_id</code>, which is just called <code>id</code> is unique. This uniqueness makes the <code>id</code> column the <strong>primary key</strong> inside the themes.csv. To see this in action, explore the themes.csv. </p><p><br></p><h4>Challenge</h4><p>How is the themes.csv structured? </p><p>Search for the name 'Star Wars'. How many <code>id</code>s correspond to the 'Star Wars' name in the themes.csv? </p><p>Use the <code>id</code>s you just found and look for the corresponding sets in the sets.csv (Hint: you'll need to look for matches in the <code>theme_id</code> column).</p><p><br></p><p>.</p><p>..</p><p>...</p><p>...</p><p>..</p><p>.</p><p><br></p><p><strong>Solution:&nbsp;Exploring the themes.csv</strong></p><p>Looking at the first 5 rows, we see the column names. Each value in the id column is unique (this is the primary key for the themes table). The theme names are not unique. If we search for the name "Star Wars", we see that 4 different ids correspond to that name. </p><figure><img src="https://img-c.udemycdn.com/redactor/raw/2020-10-10_10-20-17-7a41efe0fd36de47692c93fd25cac833.png"></figure><p>Why would Star Wars have so many different themes?&nbsp;We can check which products corresponded to those themes in the sets.csv:</p><figure><img src="https://img-c.udemycdn.com/redactor/raw/2020-10-10_10-20-26-e9094eb0b1ab6154493c48b700afd79b.png"></figure><p>Star Wars is a really long-running franchise. Theme number 18 was running from 2000 to 2002 and seems to be comprised of several of the show's characters. What about, say theme 209?</p><figure><img src="https://img-c.udemycdn.com/redactor/raw/2020-10-10_10-20-36-7d96567244914b1ebed80bab681225bd.png"></figure><p>Here we see that all of the Star Wars Advent Calendars share the same theme_id. That makes sense. </p><figure><img src="https://img-c.udemycdn.com/redactor/raw/2020-10-10_10-20-45-635c014ae055a295c7e605acb5cd3bc1.jpg"></figure><p><br></p><p><br></p><p><br></p>