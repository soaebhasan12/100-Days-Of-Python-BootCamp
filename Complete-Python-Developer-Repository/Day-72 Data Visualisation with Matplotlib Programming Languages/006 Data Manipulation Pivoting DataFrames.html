<p><strong>The </strong><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.pivot.html" rel="noopener noreferrer" target="_blank"><strong>.pivot()</strong></a><strong> method</strong></p><p>Sometimes you want to convert your DataFrame so that each category has its own column. For example, suppose you needed to take the table below and create a separate column for each actor, where each row is the Age of the actor:</p><figure><img src="https://img-c.udemycdn.com/redactor/raw/2020-09-23_14-13-02-d87f678153b7f925e4fba57d50e6be42.png" style="width: 100%;"></figure><p>How would you do this with the DataFrame below?&nbsp;</p><pre class="prettyprint linenums">test_df = pd.DataFrame({'Age': ['Young', 'Young', 'Young', 'Young', 'Old', 'Old', 'Old', 'Old'],
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'Actor': ['Jack', 'Arnold', 'Keanu', 'Sylvester', 'Jack', 'Arnold', 'Keanu', 'Sylvester'],
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'Power': [100, 80, 25, 50, 99, 75, 5, 30]})
test_df</pre><p>The easiest way to accomplish this is by using the <code>.pivot()</code> method in Pandas. Try the example for yourself. The thing to understand is how to supply the correct aguments to get the desired outcome. The index are the categories for the rows. The columns are the categories for the columns. And the values are what you want in the new cells.&nbsp; </p><pre class="prettyprint linenums">pivoted_df = test_df.pivot(index='Age', columns='Actor', values='Power')
pivoted_df</pre><p>However, there's one very important thing to notice. What happens if a value is missing?&nbsp;In the example above there's no value for old Sylvester. In this case, the .pivot() method will insert a NaN&nbsp;value.</p><p><strong>Mini-Challenge</strong></p><ul><li><p>Can you pivot the <code>df</code> DataFrame so that each row is a date and each column is a programming language? Store the result under a variable called <code>reshaped_df</code>.&nbsp; </p></li><li><p>Examine the dimensions of the reshaped DataFrame. How many rows does it have?&nbsp;How many columns?</p></li><li><p>Examine the head and the tail of the DataFrame. What does it look like?</p></li><li><p>Print out the column names.</p></li><li><p>Count the number of entries per column. </p></li></ul><p>You should get something like this:</p><figure><img src="https://img-c.udemycdn.com/redactor/raw/2020-09-23_14-27-55-8546c808e45a701c9bdeda01a143b6ee.png" style="width: 100%;"></figure><p><br></p><p><br></p><p><br></p><p><strong>Solution</strong></p><p>Here's how you pivot our existing DataFrame to get the outcome above:</p><pre class="prettyprint linenums">reshaped_df = df.pivot(index='DATE', columns='TAG', values='POSTS')</pre><figure><img style="width: 100%;" src="https://img-c.udemycdn.com/redactor/raw/2020-09-23_14-31-18-670a7feecfbf419b590b726011272d6b.png"></figure><p>We have 145 rows and 14 columns in the new DataFrame. Each programming language became a column and our date column became the new index (i.e., the label for the rows). </p><p>When we count the number of entries per column we see that not all languages are the same. The reason is that the .count() method excludes NaN values. When we pivoted the DataFrame the NaN&nbsp;values were inserted when there were no posts for a language in that month (e.g., Swift in July, 2008). </p><figure><img style="width: 100%;" src="https://img-c.udemycdn.com/redactor/raw/2020-09-23_14-34-29-8c9748278d5ebf22fe5c302f168b2374.png"></figure><p><strong>Dealing with NaN Values</strong></p><p>In this case, we don't want to drop the rows that have a NaN&nbsp;value. Instead, we want to substitute the number 0 for each NaN value in the DataFrame. We can do this with the<code> .fillna()</code> method. </p><pre class="prettyprint linenums">reshaped_df.fillna(0, inplace=True) </pre><p>The <code>inplace</code> argument means that we are updating reshaped_df. Without this argument we would have to write something like this:</p><pre class="prettyprint linenums">reshaped_df = reshaped_df.fillna(0) </pre><p>Let's check if we successfully replaced all the NaN&nbsp;values in our DataFrame. </p><figure><img style="width: 100%;" src="https://img-c.udemycdn.com/redactor/raw/2020-10-10_09-29-00-fc06492f23b6024594050f7035777e10.png"></figure><p>We can also check if there are any NaN&nbsp;values left in the entire DataFrame with this line:</p><pre class="prettyprint linenums">reshaped_df.isna().values.any()</pre><p>Here we are using the <code>.isna()</code> method that we've used before, but we're chaining two more things:&nbsp;the <code>values</code> attribute and the <code>any()</code> method. This means we don't have to search through the entire DataFrame to spot if <code>.isna()</code> is True. </p><figure><img style="width: 100%;" src="https://img-c.udemycdn.com/redactor/raw/2020-10-10_09-29-22-32eddb02d5f95698f34a2a77356b8c80.png"></figure><p>Now we're all set to create some charts and visualise our data. For all of that and more, I'll see you in the next lesson!</p>